# =========================================
# NLP Pipeline Configuration
# Fintech Review Analytics - Task 2
# =========================================

nlp:
  # Language settings
  language: "en"
  detect_language: true

  # Text normalization
  clean_text: true
  steps:
    - "lowercase"
    - "remove_urls"
    - "remove_html"
    - "remove_emojis"
    - "remove_special_chars"
    - "normalize_whitespace"

  # Stopwords
  stopwords:
    enabled: true
    custom: []             # Add project-specific stopwords if needed

  # Lemmatization / Stemming
  lemmatize: true
  stem: false              # Enable only if doing keyword clustering

  # Sentence splitting (for transformer sentiment or contextual keyword extraction)
  sentence_tokenize: true


# -----------------------------------------
# SENTIMENT ANALYSIS
# -----------------------------------------
sentiment:
  enabled: true
  engine: "vader"           # | transformer
  transformer_model: "distilbert-base-uncased-finetuned-sst-2-english" # recommended for reviews
  batch_size: 16                  # For transformer inference
  device: "cpu"                   # "cuda" if GPU available
  rolling_window: 3               # Optional smoothing for noisy reviews
  aggregate_by: ["bank", "rating"] # For summarization


# -----------------------------------------
# KEYWORD EXTRACTION
# -----------------------------------------
keywords:
  enabled: true
  method: "tfidf"                 # Options: tfidf | rake | yake | keybert
  tfidf:
    top_n: 50                     # Number of keywords per group (e.g., per bank)
    ngram_range: [1,2]            # Unigrams + bigrams
    min_df: 2                     # Ignore very rare terms
    max_df: 0.9                   

  rake:
    min_len: 1
    max_len: 4

  yake:
    max_ngram_size: 3
    deduplication_threshold: 0.1
    top_k: 15

  keybert:
    model: "all-mpnet-base-v2"
    top_k: 10
    use_mmr: true


# -----------------------------------------
# THEME EXTRACTION
# -----------------------------------------
themes:
  enabled: true
  method: "manual"               # Options: manual | lda | kmeans | nmf | hdbscan
  # For manual rule-based clustering (recommended for fintech reviews)
  rules:
    - name: "Account Access Issues"
      keywords: ["login", "password", "otp", "pin", "access"]
    - name: "Transaction Performance"
      keywords: ["slow", "transfer", "payment", "processing", "timeout", "failed"]
    - name: "User Interface & Experience"
      keywords: ["ui", "layout", "design", "navigation", "experience", "ux"]
    - name: "Customer Support"
      keywords: ["support", "help", "call", "service", "response"]
    - name: "Feature Requests"
      keywords: ["feature", "add", "improve", "fingerprint", "budget", "notification"]

  lda:
    num_topics: 8
    max_iter: 300

  kmeans:
    clusters: 10
    max_iter: 300

  nmf:
    components: 6

  hdbscan:
    min_cluster_size: 20


# -----------------------------------------
# OUTPUT SETTINGS
# -----------------------------------------
output:
  save_clean_text: true
  save_sentiment: true
  save_keywords: true
  save_themes: true

  clean_text_path: "data/interim/cleaned_reviews.csv"
  enriched_output_path: "data/processed/nlp_enriched_reviews.csv"
  sentiment_path: "../data/processed/reviews_with_sentiment.csv"
  themes_path: "data/processed/reviews_with_themes.csv"
