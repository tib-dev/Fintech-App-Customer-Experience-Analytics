# =========================================
# NLP Pipeline Configuration
# Fintech Review Analytics
# =========================================

nlp:
  language: "en"
  detect_language: true

  text_cleaning:
    enabled: true
    steps:
      - lowercase
      - remove_urls
      - remove_html
      - remove_emojis
      - remove_special_chars
      - normalize_whitespace

  stopwords:
    enabled: true
    custom: [] # Add project-specific stopwords if needed

  lemmatization: true
  stemming: false # Enable only if doing keyword clustering
  sentence_tokenize: true # Useful for transformer models

# -----------------------------------------
# SENTIMENT ANALYSIS
# -----------------------------------------
sentiment:
  enabled: true
  engine: "vader" # Options: vader | transformer
  transformer:
    model: "distilbert-base-uncased-finetuned-sst-2-english"
    batch_size: 16
    device: "cpu" # "cuda" if GPU available
  rolling_window: 3 # Optional smoothing
  aggregate_by: ["bank", "rating"] # Summarization keys

# -----------------------------------------
# KEYWORD EXTRACTION
# -----------------------------------------
keywords:
  enabled: true
  method: "tfidf" # Options: tfidf | rake | yake | keybert
  tfidf:
    top_n: 50 # Keywords per group (bank)
    ngram_range: [1, 2] # Unigrams + bigrams
    min_df: 2 # Ignore rare terms
    max_df: 0.9 # Ignore overly frequent terms
  rake:
    min_len: 1
    max_len: 4
  yake:
    max_ngram_size: 3
    deduplication_threshold: 0.1
    top_k: 15
  keybert:
    model: "all-mpnet-base-v2"
    top_k: 10
    use_mmr: true

# -----------------------------------------
# THEME EXTRACTION
# -----------------------------------------
themes:
  enabled: true
  method: "manual" # Options: manual | lda | kmeans | nmf | hdbscan
  rules:
    - name: "Account Access"
      keywords:
        [
          "login",
          "password",
          "otp",
          "pin",
          "access",
          "signin",
          "face id",
          "biometric",
          "fingerprint",
        ]
    - name: "Transaction Performance"
      keywords:
        [
          "slow",
          "transfer",
          "payment",
          "processing",
          "timeout",
          "failed",
          "delay",
          "lag",
        ]
    - name: "User Interface / UX"
      keywords:
        [
          "ui",
          "layout",
          "design",
          "navigation",
          "experience",
          "ux",
          "confusing",
          "easy to use",
        ]
    - name: "Customer Support"
      keywords:
        ["support", "help", "call", "service", "response", "agent", "contact"]
    - name: "Feature Requests"
      keywords:
        [
          "feature",
          "add",
          "improve",
          "notification",
          "offline",
          "receipt",
          "balance",
          "scan",
        ]

  lda:
    num_topics: 8
    max_iter: 300

  kmeans:
    clusters: 10
    max_iter: 300

  nmf:
    components: 6

  hdbscan:
    min_cluster_size: 20

# -----------------------------------------
# OUTPUT SETTINGS
# -----------------------------------------
output:
  save_clean_text: true
  save_sentiment: true
  save_keywords: true
  save_themes: true

  clean_text_path: "data/interim/cleaned_reviews.csv"
  enriched_output_path: "data/processed/nlp_enriched_reviews.csv"
  sentiment_path: "data/processed/reviews_with_sentiment.csv"
  themes_path: "data/processed/reviews_with_themes.csv"
